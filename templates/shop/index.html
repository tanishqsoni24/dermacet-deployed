{% extends 'base.html' %}

{% block title %}

<title>
    Shop | Dermacet Organics
</title>

  {% endblock %}

{% block start %}
    <!-- Start offcanvas filter sidebar -->
    <div class="offcanvas__filter--sidebar widget__area">
        <button type="button" class="offcanvas__filter--close" data-offcanvas="">
            <svg class="minicart__close--icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512"><path fill="currentColor" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M368 368L144 144M368 144L144 368"></path></svg> <span class="offcanvas__filter--close__text">Close</span>
        </button>
        <div class="offcanvas__filter--sidebar__inner">
            <div class="single__widget widget__bg">
                <h2 class="widget__title h3">Categories</h2>
                <ul class="widget__categories--menu">
                    {% for cat in category %}
                    <li class="widget__categories--menu__list">
                        <label class="widget__categories--menu__label d-flex align-items-center">
                            <img class="widget__categories--menu__img" src="/media/{{cat.cat_image}}" alt="categories-img">
                            <span class="widget__categories--menu__text">{{cat.cat_name}}</span>
                            <svg class="widget__categories--menu__arrowdown--icon" xmlns="http://www.w3.org/2000/svg" width="12.355" height="8.394">
                                <path d="M15.138,8.59l-3.961,3.952L7.217,8.59,6,9.807l5.178,5.178,5.178-5.178Z" transform="translate(-6 -8.59)" fill="currentColor"></path>
                            </svg>
                        </label>
                        <ul class="widget__categories--sub__menu">
                            {% for product in cat.products.all %}
                            <li class="widget__categories--sub__menu--list">
                                <a class="widget__categories--sub__menu--link d-flex align-items-center" href="{% url 'Product' product.slug %}">
                                    <img class="widget__categories--sub__menu--img" src="/media/{{product.product_images.first.image}}" alt="categories-img">
                                    <span class="widget__categories--sub__menu--text">{{product.prod_name}}</span>
                                </a>
                            </li>
                            {% endfor %}
                        </ul>
                    </li>
                    {% endfor %}
                </ul>
            </div>
            <div class="single__widget widget__bg">
                <h2 class="widget__title h3">Top Reviewed Product</h2>
                <div class="shop__sidebar--product">
                    {% for product in top_products %}
                    <div class="small__product--card d-flex">
                        <div class="small__product--thumbnail">
                            <a class="display-block" href="{% url 'Product' product.slug %}"><img src="/media/{{product.product_images.first.image}}" alt="product-img"></a>
                        </div>
                        <div class="small__product--content">
                            <h3 class="small__product--card__title"><a href="{% url 'Product' product.slug %}">{{product.prod_name}}</a></h3>
                            <div class="small__product--card__price mb_5">
                                <span class="current__price">₹{{product.your_price}}</span>
                            </div>
                            <ul class="rating small__product--rating d-flex">
                                <li class="rating__list">
                                    <span class="rating__icon">
                                        Reviews ({{product.reviews.all.count}})
                                    </span>
                                </li>
                            </ul>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
    <!-- End offcanvas filter sidebar -->

    <main class="main__content_wrapper">
        
        <!-- Start breadcrumb section -->
        <div class="breadcrumb__section breadcrumb__bg">
            <div class="container">
                <div class="row row-cols-1">
                    <div class="col">
                        <div class="breadcrumb__content text-center">
                            <h1 class="breadcrumb__content--title">Products</h1>
                            <ul class="breadcrumb__content--menu d-flex justify-content-center">
                                <li class="breadcrumb__content--menu__items"><a href="/">Home</a></li>
                                <li class="breadcrumb__content--menu__items"><span>Shop</span></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- End breadcrumb section -->

        <!-- Start collection section -->
        <section class="shop__collection--section section--padding">
            <div class="container">
                <div class="section__heading text-center mb-40">
                    <h2 class="section__heading--maintitle">Shop By Category</h2>
                </div>
                <div class="shop__collection--column5 swiper">
                    <div class="swiper-wrapper">
                        {% for cat in category %}
                        <div class="swiper-slide">
                            <div class="shop__collection--card text-center">
                                <a class="shop__collection--link" href="/shop/?category={{cat.cat_name}}">
                                    <img class="shop__collection--img" src="/media/{{cat.cat_image}}" alt="icon-img">
                                    <h3 class="shop__collection--title mb-0">{{cat.cat_name}}</h3>
                                </a>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    <div class="swiper__nav--btn swiper-button-next">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class=" -chevron-right"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    </div>
                    <div class="swiper__nav--btn swiper-button-prev">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class=" -chevron-left"><polyline points="15 18 9 12 15 6"></polyline></svg>
                    </div>
                </div>
            </div>
        </section>
        <!-- End collection section -->

        <!-- Start shop section -->
        <div class="shop__section section--padding pt-0">
            <div class="container">
                <div class="row">
                    <div class="col-xl-3 col-lg-4 shop-col-width-lg-4">
                        <div class="shop__sidebar--widget widget__area d-none d-lg-block">
                            <div class="single__widget widget__bg">
                                <h2 class="widget__title h3">Categories</h2>
                                <ul class="widget__categories--menu">
                                    {% for cat in category %}
                                    <li class="widget__categories--menu__list">
                                        <label class="widget__categories--menu__label d-flex align-items-center">
                                            <img class="widget__categories--menu__img" src="/media/{{cat.cat_image}}" alt="categories-img">
                                            <span class="widget__categories--menu__text">{{cat.cat_name}}</span>
                                            <svg class="widget__categories--menu__arrowdown--icon" xmlns="http://www.w3.org/2000/svg" width="12.355" height="8.394">
                                                <path d="M15.138,8.59l-3.961,3.952L7.217,8.59,6,9.807l5.178,5.178,5.178-5.178Z" transform="translate(-6 -8.59)" fill="currentColor"></path>
                                            </svg>
                                        </label>
                                        <ul class="widget__categories--sub__menu">
                                            {% for product in cat.products.all %}
                                            <li class="widget__categories--sub__menu--list">
                                                <a class="widget__categories--sub__menu--link d-flex align-items-center" href="{% url 'Product' product.slug %}">
                                                    <img class="widget__categories--sub__menu--img" src="/media/{{product.product_images.first.image}}" alt="categories-img">
                                                    <span class="widget__categories--sub__menu--text">{{ product.prod_name }}</span>
                                                </a>
                                            </li>
                                            {% endfor %}
                                        </ul>
                                    </li>
                                    {% endfor %}
                                </ul>
                            </div>
                            <div class="single__widget widget__bg">
                                <h2 class="widget__title h3">Top Reviewed Product</h2>
                                <div class="shop__sidebar--product">
                                    {% for product in top_products %}
                                    <div class="small__product--card d-flex">
                                        <div class="small__product--thumbnail">
                                            <a class="display-block" href="{% url 'Product' product.slug %}"><img src="/media/{{product.product_images.first.image}}" alt="product-img"></a>
                                        </div>
                                        <div class="small__product--content">
                                            <h3 class="small__product--card__title"><a href="{% url 'Product' product.slug %}">{{ product.prod_name }}</a></h3>
                                            <div class="small__product--card__price mb_5">
                                                <span class="current__price">₹{{ product.your_price }}</span>
                                            </div>
                                            <ul class="rating small__product--rating d-flex">
                                                <li class="rating__list">
                                                    <span class="rating__icon">
                                                        Reviews ({{ product.reviews.count }})
                                                    </span>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-9 col-lg-8 shop-col-width-lg-8">
                        <div class="shop__product--wrapper position__sticky">
                            <div class="shop__header d-flex align-items-center justify-content-between mb-30">
                                <div class="product__view--mode d-flex align-items-center">
                                    <button class="widget__filter--btn d-flex d-lg-none align-items-center" data-offcanvas="">
                                        <svg class="widget__filter--btn__icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="28" d="M368 128h80M64 128h240M368 384h80M64 384h240M208 256h240M64 256h80"></path><circle cx="336" cy="128" r="28" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="28"></circle><circle cx="176" cy="256" r="28" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="28"></circle><circle cx="336" cy="384" r="28" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="28"></circle></svg> 
                                        <span class="widget__filter--btn__text">Filter</span>
                                    </button>
                                    <div class="product__view--mode__list product__short--by align-items-center d-flex">
                                        <label class="product__view--label">Sort By :</label>
                                        <div class="select shop__header--select">
                                            <select name="" id="" class="product__view--select" onchange="sort_products(this.value)">
                                                {% if checked_sort == "Popularity" %}
                                                <option value="Popularity">Popularity</option>
                                                <option value="Default">Default</option>
                                                <option value="Price - High to Low">Price - High to Low</option>
                                                <option value="Price - Low to High">Price - Low to High</option>
                                            {% elif checked_sort == "Price - High to Low" %}
                                                <option value="Price - High to Low">Price - High to Low</option>
                                                <option value="Default">Default</option>
                                                <option value="Popularity">Popularity</option>
                                                <option value="Price - Low to High">Price - Low to High</option>
                                            {% elif checked_sort == "Price - Low to High" %}
                                                <option value="Price - Low to High">Price - Low to High</option>
                                                <option value="Default">Default</option>
                                                <option value="Popularity">Popularity</option>
                                                <option value="Price - High to Low">Price - High to Low</option>
                                            {% else %}
                                                <option value="Default">Sort By</option>
                                                <option value="Popularity">Popularity</option>
                                                <option value="Price - High to Low">Price - High to Low</option>
                                                <option value="Price - Low to High">Price - Low to High</option>
                                            {% endif %}
                                            </select>
                                        </div>
                                         
                                    </div>
                                    <div class="product__view--mode__list">
                                        <div class="product__tab--one product__grid--column__buttons d-flex justify-content-center">
                                            <button class="product__grid--column__buttons--icons active" aria-label="grid btn" data-toggle="tab" data-target="#product_grid">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" viewbox="0 0 9 9">
                                                    <g transform="translate(-1360 -479)">
                                                      <rect id="Rectangle_5725" data-name="Rectangle 5725" width="4" height="4" transform="translate(1360 479)" fill="currentColor"></rect>
                                                      <rect id="Rectangle_5727" data-name="Rectangle 5727" width="4" height="4" transform="translate(1360 484)" fill="currentColor"></rect>
                                                      <rect id="Rectangle_5726" data-name="Rectangle 5726" width="4" height="4" transform="translate(1365 479)" fill="currentColor"></rect>
                                                      <rect id="Rectangle_5728" data-name="Rectangle 5728" width="4" height="4" transform="translate(1365 484)" fill="currentColor"></rect>
                                                    </g>
                                                </svg>
                                            </button>
                                            <button class="product__grid--column__buttons--icons" aria-label="list btn" data-toggle="tab" data-target="#product_list">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="17" height="16" viewbox="0 0 13 8">
                                                    <g id="Group_14700" data-name="Group 14700" transform="translate(-1376 -478)">
                                                      <g transform="translate(12 -2)">
                                                        <g id="Group_1326" data-name="Group 1326">
                                                          <rect id="Rectangle_5729" data-name="Rectangle 5729" width="3" height="2" transform="translate(1364 483)" fill="currentColor"></rect>
                                                          <rect id="Rectangle_5730" data-name="Rectangle 5730" width="9" height="2" transform="translate(1368 483)" fill="currentColor"></rect>
                                                        </g>
                                                        <g id="Group_1328" data-name="Group 1328" transform="translate(0 -3)">
                                                          <rect id="Rectangle_5729-2" data-name="Rectangle 5729" width="3" height="2" transform="translate(1364 483)" fill="currentColor"></rect>
                                                          <rect id="Rectangle_5730-2" data-name="Rectangle 5730" width="9" height="2" transform="translate(1368 483)" fill="currentColor"></rect>
                                                        </g>
                                                        <g id="Group_1327" data-name="Group 1327" transform="translate(0 -1)">
                                                          <rect id="Rectangle_5731" data-name="Rectangle 5731" width="3" height="2" transform="translate(1364 487)" fill="currentColor"></rect>
                                                          <rect id="Rectangle_5732" data-name="Rectangle 5732" width="9" height="2" transform="translate(1368 487)" fill="currentColor"></rect>
                                                        </g>
                                                      </g>
                                                    </g>
                                                  </svg>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                {% if checked_category %}
                                <p class="product__showing--count"><strong>Category : {{checked_category}}</strong>, Showing of {{products|length}} results</p>
                                {% else %}
                                <p class="product__showing--count">Showing of {{products|length}} results</p>
                                {% endif %}
                            </div>
                            <div class="tab_content">
                                <div id="product_grid" class="tab_pane active show">
                                    <div class="product__section--inner">
                                        {% if products|length %}
                                        <div class="row mb--n30">
                                            {% for product in products %}
                                            <div class="col-lg-4 col-md-4 col-sm-6 col-6 custom-col mb-30">
                                                <article class="product__card">
                                                    <div class="product__card--thumbnail">
                                                        <a class="product__card--thumbnail__link display-block" href="{% url 'Product' product.slug %}">
                                                            <img class="product__card--thumbnail__img product__primary--img" src="/media/{{product.product_images.first.image}}" alt="product-img">
                                                            <img class="product__card--thumbnail__img product__secondary--img" src="/media/{{product.product_images.first.image}}" alt="product-img">
                                                        </a>
                                                        <span class="product__badge">-{{product.pecentage}}%</span>
                                                        <div class="product__add--to__card">
                                                            <a class="product__card--btn" title="Add To Card" href="{% url 'cart' product.uid %}">+ Add to Cart
                                                            </a>
                                                        </div>
                                                    </div>
                                                    <div class="product__card--content text-center">
                                                        <ul class="rating product__card--rating d-flex justify-content-center">
                                                            <li>
                                                                <span class="rating__review--text">({{ product.reviews.all|length }}) Review</span>
                                                            </li>
                                                        </ul>
                                                        <h3 class="product__card--title"><a href="{% url 'Product' product.slug %}">{{product.prod_name}}</a></h3>
                                                        <div class="product__card--price">
                                                            <span class="current__price">₹{{product.your_price}}</span>
                                                            <span class="old__price"> ₹{{product.price}}</span>
                                                        </div>  
                                                    </div>
                                                </article>
                                            </div>
                                            {% endfor %}
                                        </div>
                                        {% else %}
                                        <div class="col-lg-12">
                                            <div class="alert alert-danger text-center" role="alert">
                                                <strong>Sorry!</strong> No Product Found.
                                            </div>
                                        </div>
                                        {% endif %}
                                    </div>
                                </div>
                                <div id="product_list" class="tab_pane">
                                    <div class="product__section--inner product__section--style3__inner">
                                        {% if products|length %}
                                        <div class="row row-cols-1 mb--n30">
                                            {% for product in products %}
                                            <div class="col mb-30">
                                                <div class="product__card product__list d-flex align-items-center">
                                                    <div class="product__card--thumbnail product__list--thumbnail">
                                                        <a class="product__card--thumbnail__link display-block" href="{% url 'Product' product.slug %}">
                                                            <img class="product__card--thumbnail__img product__primary--img" src="/media/{{product.product_images.first.image}}" alt="product-img">
                                                            <img class="product__card--thumbnail__img product__secondary--img" src="/media/{{product.product_images.first.image}}" alt="product-img">
                                                        </a>
                                                        <span class="product__badge">-{{product.pecentage}}%</span>
                                                    </div>
                                                    <div class="product__card--content product__list--content">
                                                        <h3 class="product__card--title"><a href="{% url 'Product' product.slug %}">{{product.prod_name}}</a></h3>
                                                        <ul class="rating product__card--rating d-flex">
                                                            <li>
                                                                <span class="rating__review--text">({{ product.reviews.all|length }}) Review</span>
                                                            </li>
                                                        </ul>
                                                        <div class="product__list--price">
                                                            <span class="current__price">₹{{ product.your_price }}</span>
                                                            <span class="old__price">₹{{ product.price }}</span>
                                                        </div>
                                                        <p class="product__card--content__desc mb-15">{{product.description.first.prod_descp|truncatechars:200}}...<a href="{% url 'Product' product.slug %}">Read More</a></p>
                                                        <a class="product__card--btn primary__btn" href="{% url 'cart' product.uid %}">+ Add to cart</a>
                                                    </div>
                                                </div>
                                            </div>
                                            {% endfor %}
                                        </div>
                                        {% else %}
                                        <div class="col-lg-12">
                                            <div class="alert alert-danger text-center" role="alert">
                                                <strong>Sorry!</strong> No Product Found.
                                            </div>
                                        </div>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- End shop section -->

    </main>

    <script>
        function sort_products(sortby) {
        const url = new URL(location.href);
        const params = new URLSearchParams(url.search);

        if (params.has('sortBy')) {
            params.delete('sortBy');
        }

        params.append('sortBy', sortby);

        url.search = params.toString();

        location.href = url.toString();
    }
    </script>

{% endblock %}